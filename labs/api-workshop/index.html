<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Security Workshop Instruction Manual</title>
    <!-- Google Fonts: Roboto and Roboto Condensed -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Roboto+Condensed:wght@700&display=swap" rel="stylesheet">
    <!-- Link to External CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="container header-container">
            <!-- Logo and Brand Name -->
            <div class="logo-text">
                <!-- White SAG Logo SVG -->
                <svg id="sagLogo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 719.656 293.2663" width="83" class="logo">
                    <!-- Replace the following path data with your actual SVG paths -->
                    <g clip-path="url(#clip0)" fill="currentColor">
                        <path d="M148.7605,286.7924c6.8899,2.1056,6.5881,6.4739-.9769,6.4739C66.1759,293.2663,0,227.5973,0,146.6394C0,65.6815,66.1759,0,147.7836,0c7.565,0,9.2151,4.0736,2.9378,5.9059C89.3316,23.7095,44.4953,79.9811,44.4953,146.6394c0,65.9493,43.9059,121.728,104.2652,140.153"/>
                        <path d="M72.4908,180.9894c-.409-3.9379-.6054-7.9205-.6054-11.9423c0-64.2902,52.1299-116.4042,116.427-116.4042c60.7914,0,79.0414,27.133,81.3041,25.3614c2.4698-1.9538-22.0593-55.7341-93.4428-55.7341-64.306,0-116.4341,52.1141-116.4341,116.4043c0,14.8729,2.7859,29.0547,7.8596,42.1024c2.1431,5.4755,5.4363,5.5201,4.8916.2125"/>
                        <path d="M120.2571,97.0936c30.26-13.1905,68.2725-13.5924,105.6438-.5304c25.0953,8.7545,39.6412,21.2557,40.8306,20.7413c1.9842-.8554-14.5995-27.1169-44.5256-38.468-36.2337-13.7299-75.2642-6.5417-103.7044,15.7587-3.1289,2.4609-1.9466,4.1111,1.7555,2.4984"/>
                    </g>
                    <!-- Clip Path (if needed) -->
                    <defs>
                        <clipPath id="clip0">
                            <rect width="719.656" height="293.2663" fill="white"/>
                        </clipPath>
                    </defs>
                </svg>
                <!-- Brand Name -->
                <span class="brand-name">x SolutionsEdge</span>
            </div>

            <!-- Workshop Title -->
            <h1>API Security Workshop Instruction Manual</h1>
            <!-- Workshop Description -->
            <p>Welcome to the <strong>API Security Workshop</strong>! This manual will guide you through the challenges using <strong>Chrome DevTools</strong> and <strong>Postman</strong> with the supplied Postman collections. By the end of this workshop, you’ll have hands-on experience identifying and mitigating common API security vulnerabilities.</p>
            
            <!-- Right-Aligned Controls: External Links and Dark Mode Toggle -->
            <div class="header-controls">
                <!-- External Links -->
                <div class="external-links">
                    <a href="https://www.solutionsedge.io" target="_blank" rel="noopener noreferrer" aria-label="Solutions Edge Blog">Blog</a>
                    <a href="https://www.akamai.com" target="_blank" rel="noopener noreferrer" aria-label="Akamai Website">Akamai</a>
                    <a href="https://www.nonamesecurity.com" target="_blank" rel="noopener noreferrer" aria-label="NoName Security">NoName Security</a>
                </div>
                
                <!-- Dark Mode Toggle Button -->
                <button id="darkModeToggle" aria-label="Toggle Dark Mode">
                    <!-- Moon Icon SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="CurrentColor" class="moon-icon" viewBox="0 0 24 24">
                        <path d="M21.752 15.002A9 9 0 0111 3v0a9 9 0 109.752 12.002z"/>
                    </svg>
                    <!-- Sun Icon SVG (Hidden by Default) -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="sun-icon" viewBox="0 0 24 24" style="display: none;">
                        <path d="M6.76 4.84l-1.8-1.79-1.42 1.42 1.79 1.8 1.43-1.43zm10.48 0l1.79-1.8-1.42-1.42-1.8 1.79 1.43 1.43zM12 5a7 7 0 100 14 7 7 0 000-14zm0-5v2m0 14v2m9-9h-2M5 12H3m16.24 6.76l-1.79-1.8M6.76 17.16l-1.79 1.8 1.42 1.42 1.8-1.79-1.43-1.43z"/>
                    </svg>
                </button>
            </div>
            
            <!-- Search Input (Optional) -->
            <input type="text" id="searchInput" placeholder="Search...">
        </div>
    </header>

    <!-- Navigation Bar -->
    <nav>
        <div class="container">
            <!-- Hamburger Menu Icon (Visible on Mobile) -->
            <button id="hamburgerMenu" aria-label="Toggle Navigation">
                &#9776;
            </button>
            <ul id="navLinks">
                <li><a href="#workshop-overview">Workshop Overview</a></li>
                <li><a href="#prerequisites">Prerequisites</a></li>
                <li><a href="#setting-up-your-environment">Setting Up</a></li>
                <li><a href="#understanding-the-tools">Tools</a></li>
                <li><a href="#workshop-challenges">Challenges</a></li>
                <li><a href="#best-practices-for-api-security">Best Practices</a></li>
                <li><a href="#solutions">Solutions</a></li>
                <li><a href="#conclusion-and-further-resources">Conclusion</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <div class="container">
            <!-- Workshop Overview Section -->
            <section id="workshop-overview">
                <h2>Workshop Overview <button class="done-toggle" aria-label="Mark as Done"></button></h2>
                <div class="section-content fade-in">
                    <p>In this workshop, you will:</p>
                    <ul>
                        <li>Learn how to use <strong>Chrome DevTools</strong> and <strong>Postman</strong> for API security testing.</li>
                        <li>Explore common API vulnerabilities through hands-on challenges.</li>
                        <li>Utilize the <strong>CrAPI</strong> lab environment to simulate real-world scenarios.</li>
                        <li>Access <strong>Mailhog</strong> for capturing and analyzing outbound emails from the API.</li>
                        <li>Apply best practices to secure APIs against common threats.</li>
                    </ul>
                </div>
            </section>

            <!-- Prerequisites Section -->
            <section id="prerequisites">
                <h2>Prerequisites <button class="done-toggle" aria-label="Mark as Done"></button></h2>
                <div class="section-content fade-in">
                    <h3>Before attending this workshop, ensure you have:</h3>
                    <ul>
                        <li>Basic understanding of APIs and HTTP protocols.</li>
                        <li>Familiarity with using web browsers and installing software.</li>
                        <li>Basic knowledge of security concepts is helpful but not required.</li>
                    </ul>
                </div>
            </section>

            <!-- Setting Up Your Environment Section -->
            <section id="setting-up-your-environment">
                <h2>Setting Up Your Environment <button class="done-toggle" aria-label="Mark as Done"></button></h2>
                <div class="section-content fade-in">
                    <h3>Installing Required Tools</h3>
                    <ol>
                        <li><strong>Google Chrome</strong>
                            <ul>
                                <li>Download and install <a href="https://www.google.com/chrome/" target="_blank" rel="noopener noreferrer">Google Chrome </a> if not already installed.</li>
                            </ul>
                        </li>
                        <li><strong>Postman</strong>
                            <ul>
                                <li>Download and install <a href="https://www.postman.com/downloads/" target="_blank" rel="noopener noreferrer">Postman</a>.</li>
                            </ul>
                        </li>
                    </ol>

                    <h3>Accessing the CrAPI Lab Environment</h3>
                    <ol>
                        <li><strong>CrAPI Access</strong>
                            <ul>
                                <li>URL: <a href="https://api-workshop.solutionsedge.io" target="_blank" rel="noopener noreferrer">api-workshop.solutionsedge.io</a></li>
                                <li>Open the provided URL in Google Chrome.</li>
                                <li>Create a user, please note to <b>ONLY USE></b> a fake email and user!.</li>
                            </ul>
                        </li>
                        <li><strong>Navigating the CrAPI Interface</strong>
                            <ul>
                                <li>Once logged in, familiarize yourself with the CrAPI dashboard.</li>
                                <li>Explore different sections such as Endpoints, Users, and Settings to understand the available functionalities.</li>
                            </ul>
                        </li>
                    </ol>

                    <h3>Accessing Mailhog</h3>
                    <p>Mailhog is a tool used to capture and inspect outbound emails sent by the CrAPI application. This is particularly useful for challenges involving email functionalities, such as password resets or account verifications.</p>
                    <ol>
                        <li><strong>Mailhog Access</strong>
                            <ul>
                                <li>URL: <a href="http://ds01.cloud.solutionsedge.io:8025" target="_blank" rel="noopener noreferrer">ds01.cloud.solutionsedge.io:8025</a></li>
                                <li>Open the provided URL in Google Chrome.</li>
                                <li>Mailhog does not require authentication; it will display all captured emails from the CrAPI environment.</li>
                            </ul>
                        </li>
                        <li><strong>Using Mailhog</strong>
                            <ul>
                                <li>Monitor outgoing emails generated by actions in CrAPI.</li>
                                <li>Inspect email contents, headers, and metadata for analysis during relevant challenges.</li>
                            </ul>
                        </li>
                    </ol>

                    <h3>Importing Postman Collections</h3>
                    <ol>
                        <li><strong>Open Postman</strong>
                            <ul>
                                <li>Launch the Postman application.</li>
                            </ul>
                        </li>
                        <li><strong>Download the Postman Collections</strong>
                            <ul>
                                <li>Access the <a href="https://github.com/OWASP/crAPI/tree/7ceb7fa890f5376fdccacc2346c9d2f32097c59f/postman_collections" target="_blank" rel="noopener noreferrer">OWASP crAPI Postman Collections Repository</a>.</li>
                                <li>Download the necessary collection files (typically `.json` files).</li>
                            </ul>
                        </li>
                        <li><strong>Import Collection</strong>
                            <ul>
                                <li>Click on the <strong>Import</strong> button in the top-left corner.</li>
                                <li>Select the downloaded Postman collection file (e.g., <code>CrAPI_Collection.json</code>).</li>
                                <li>Click <strong>Import</strong> to add the collection to your workspace.</li>
                            </ul>
                        </li>
                        <li><strong>Configure Environment Variables</strong>
                            <ul>
                                <li>If an environment file is provided (e.g., <code>CrAPI_Environment.json</code>), import it similarly.</li>
                                <li>Set the base URL to <code>https://api-workshop.solutionsedge.io</code> if not pre-configured.</li>
                            </ul>
                        </li>
                    </ol>
                </div>
            </section>

            <!-- Understanding the Tools Section -->
            <section id="understanding-the-tools">
                <h2>Understanding the Tools <button class="done-toggle" aria-label="Mark as Done"></button></h2>
                <div class="section-content fade-in">
                    <h3>Chrome DevTools Overview</h3>
                    <p><strong>Chrome DevTools</strong> is a set of web developer tools built directly into the Google Chrome browser. It allows you to:</p>
                    <ul>
                        <li>Inspect and modify the DOM and CSS.</li>
                        <li>Debug JavaScript code.</li>
                        <li>Monitor network activity, including API requests and responses.</li>
                        <li>Analyze performance and security issues.</li>
                    </ul>
                    <p><strong>Accessing DevTools:</strong></p>
                    <ul>
                        <li>Right-click on any webpage element and select <strong>Inspect</strong>, or press <code>Ctrl+Shift+I</code> (Windows/Linux) or <code>Cmd+Option+I</code> (Mac).</li>
                    </ul>
                    <h4>Key Panels:</h4>
                    <ul>
                        <li><strong>Elements:</strong> Inspect and modify HTML and CSS.</li>
                        <li><strong>Console:</strong> View and execute JavaScript.</li>
                        <li><strong>Network:</strong> Monitor network requests and responses.</li>
                        <li><strong>Sources:</strong> Debug JavaScript code.</li>
                        <li><strong>Security:</strong> Analyze security issues like mixed content and certificate details.</li>
                    </ul>

                    <h3>Postman Overview</h3>
                    <p><strong>Postman</strong> is a powerful tool for API development and testing. It allows you to:</p>
                    <ul>
                        <li>Send HTTP requests to APIs.</li>
                        <li>Organize requests into collections.</li>
                        <li>Automate testing with scripts.</li>
                        <li>Analyze responses and debug issues.</li>
                    </ul>
                    <h4>Key Features:</h4>
                    <ul>
                        <li><strong>Collections:</strong> Group related API requests.</li>
                        <li><strong>Environments:</strong> Manage different sets of variables (e.g., development, staging, production).</li>
                        <li><strong>Tests:</strong> Write scripts to validate responses.</li>
                    </ul>
                    <p><strong>Using Postman with CrAPI:</strong></p>
                    <ul>
                        <li>Utilize the imported <strong>CrAPI_Collection</strong> to interact with various API endpoints.</li>
                        <li>Use environment variables to manage authentication tokens and other dynamic data.</li>
                        <li>Leverage scripts to automate repetitive tasks during challenges.</li>
                    </ul>
                </div>
            </section>

            <!-- Workshop Challenges Section -->
            <section id="workshop-challenges">
                <h2>Workshop Challenges <button class="done-toggle" aria-label="Mark as Done"></button></h2>
                <div class="section-content fade-in">
                    <p>Each challenge is designed to teach you about specific API security vulnerabilities. Attempt to solve each challenge before viewing the solution.</p>

                    <!-- BOLA Vulnerabilities Section -->
                    <div class="challenge-group">
                        <h3>BOLA Vulnerabilities</h3>

                        <!-- Challenge 1 -->
                        <div class="challenge">
                            <h4>Challenge 1 - Access details of another user’s vehicle</h4>
                            <p>To solve the challenge, you need to leak sensitive information of another user’s vehicle.</p>
                            <p>Since vehicle IDs are not sequential numbers, but GUIDs, you need to find a way to expose the vehicle ID of another user.</p>
                            <p>Find an API endpoint that receives a vehicle ID and returns information about it.</p>
                        </div>

                        <!-- Challenge 2 -->
                        <div class="challenge">
                            <h4>Challenge 2 - Access mechanic reports of other users</h4>
                            <p>crAPI allows vehicle owners to contact their mechanics by submitting a "contact mechanic" form. This challenge is about accessing mechanic reports that were submitted by other users.</p>
                            <p>Analyze the report submission process</p>
                            <p>Find a hidden API endpoint that exposes details of a mechanic report</p>
                            <p>Change the report ID to access other reports</p>
                        </div>
                    </div>

                    <!-- Broken User Authentication Section -->
                    <div class="challenge-group">
                        <h3>Broken User Authentication</h3>

                        <!-- Challenge 3 -->
                        <div class="challenge">
                            <h4>Challenge 3 - Reset the password of a different user</h4>
                            <p>Find an email address of another user on crAPI</p>
                            <p>Brute forcing might be the answer. If you face any protection mechanisms, remember to leverage the predictable nature of REST APIs to find more similar API endpoints.</p>
                        </div>
                    </div>

                    <!-- Excessive Data Exposure Section -->
                    <div class="challenge-group">
                        <h3>Excessive Data Exposure</h3>

                        <!-- Challenge 4 -->
                        <div class="challenge">
                            <h4>Challenge 4 - Find an API endpoint that leaks sensitive information of other users</h4>
                        </div>

                        <!-- Challenge 5 -->
                        <div class="challenge">
                            <h4>Challenge 5 - Find an API endpoint that leaks an internal property of a video</h4>
                            <p>In this challenge, you need to find an internal property of the video resource that shouldn’t be exposed to the user. This property name and value can help you to exploit other vulnerabilities.</p>
                        </div>
                    </div>

                    <!-- Rate Limiting Section -->
                    <div class="challenge-group">
                        <h3>Rate Limiting</h3>

                        <!-- Challenge 6 -->
                        <div class="challenge">
                            <h4>Challenge 6 - Perform a layer 7 DoS using ‘contact mechanic’ feature</h4>
                        </div>
                    </div>

                    <!-- BFLA Section -->
                    <div class="challenge-group">
                        <h3>BFLA</h3>

                        <!-- Challenge 7 -->
                        <div class="challenge">
                            <h4>Challenge 7 - Delete a video of another user</h4>
                            <p>Leverage the predictable nature of REST APIs to find an admin endpoint to delete videos</p>
                            <p>Delete a video of someone else</p>
                        </div>
                    </div>

                    <!-- Mass Assignment Section -->
                    <div class="challenge-group">
                        <h3>Mass Assignment</h3>

                        <!-- Challenge 8 -->
                        <div class="challenge">
                            <h4>Challenge 8 - Get an item for free</h4>
                            <p>crAPI allows users to return items they have ordered. You simply click the "return order" button, receive a QR code and show it in a USPS store. To solve this challenge, you need to find a way to get refunded for an item that you haven’t actually returned.</p>
                            <p>Leverage the predictable nature of REST APIs to find a shadow API endpoint that allows you to edit properties of a specific order.</p>
                        </div>

                        <!-- Challenge 9 -->
                        <div class="challenge">
                            <h4>Challenge 9 - Increase your balance by $1,000 or more</h4>
                            <p>After solving the "Get an item for free" challenge, be creative and find a way to get refunded for an item you never returned, but this time try to get a bigger refund.</p>
                        </div>

                        <!-- Challenge 10 -->
                        <div class="challenge">
                            <h4>Challenge 10 - Update internal video properties</h4>
                            <p>After solving the "Find an API endpoint that leaks an internal property of videos" challenge, try to find an endpoint that would allow you to change the internal property of the video. Changing the value can help you to exploit another vulnerability.</p>
                        </div>
                    </div>

                    <!-- SSRF Section -->
                    <div class="challenge-group">
                        <h3>SSRF</h3>

                        <!-- Challenge 11 -->
                        <div class="challenge">
                            <h4>Challenge 11 - Make crAPI send an HTTP call to "www.google.com" and return the HTTP response.</h4>
                        </div>
                    </div>

                    <!-- NoSQL Injection Section -->
                    <div class="challenge-group">
                        <h3>NoSQL Injection</h3>

                        <!-- Challenge 12 -->
                        <div class="challenge">
                            <h4>Challenge 12 - Find a way to get free coupons without knowing the coupon code.</h4>
                        </div>
                    </div>

                    <!-- SQL Injection Section -->
                    <div class="challenge-group">
                        <h3>SQL Injection</h3>

                        <!-- Challenge 13 -->
                        <div class="challenge">
                            <h4>Challenge 13 - Find a way to redeem a coupon that you have already claimed by modifying the database</h4>
                        </div>
                    </div>

                    <!-- Unauthenticated Access Section -->
                    <div class="challenge-group">
                        <h3>Unauthenticated Access</h3>

                        <!-- Challenge 14 -->
                        <div class="challenge">
                            <h4>Challenge 14 - Find an endpoint that does not perform authentication checks for a user.</h4>
                        </div>
                    </div>

                    <!-- JWT Vulnerabilities Section -->
                    <div class="challenge-group">
                        <h3>JWT Vulnerabilities</h3>

                        <!-- Challenge 15 -->
                        <div class="challenge">
                            <h4>Challenge 15 - Find a way to forge valid JWT Tokens</h4>
                            <p>JWT Authentication in crAPI is vulnerable to various attacks. Find any one way to forge a valid JWT token and get full access to the platform.</p>
                        </div>
                    </div>

                    <!-- Secret Challenges Section -->
                    <div class="challenge-group">
                        <h3>&lt;&lt; 2 Secret Challenges &gt;&gt;</h3>
                        <p>There are two more secret challenges in crAPI, that are pretty complex, and for now we don’t share details about them, except the fact they are really cool.</p>
                    </div>
                </div>
            </section>

            <!-- Solutions Section -->
            <section id="solutions">
                <h2>Solutions <button class="done-toggle" aria-label="Mark as Done"></button></h2>
                <div class="section-content fade-in">
                    <h3>Solutions</h3>
                    <p>It is assumed that the container crapi-web is running in port 8888. Verify the ports of the container by running the following command: <code>docker ps</code></p>

                    <!-- BOLA Vulnerabilities Solutions -->
                    <div class="challenge-group">
                        <h4>BOLA Vulnerabilities</h4>

                        <!-- Challenge 1 Solution -->
                        <div class="challenge-solution">
                            <h5>Challenge 1 - Access details of another user’s vehicle</h5>
                            <div id="solution1" class="solution-content">
                                <h6>Detailed Solution</h6>
                                <ol>
                                    <li><strong>Login to the application</strong> from <a href="http://localhost:8888/login" target="_blank" rel="noopener noreferrer">http://localhost:8888/login</a>.</li>
                                    <li>From the Dashboard, choose <strong>Add a Vehicle</strong> and add the vehicle by providing the VIN and pincode received in the Mailhog mailbox after Signup or by reinitiating from the Dashboard page.</li>
                                    <li>After the vehicle details are successfully verified, the vehicle will get added and then be populated in the Dashboard page.</li>
                                    <li>Observe the request sent when you click <strong>Refresh Location</strong>. It can be seen that the endpoint is in the format <code>/identity/api/v2/vehicle/&lt;vehicleid&gt;/location</code>.</li>
                                    <li>Sensitive information like latitude and longitude are provided back in the response for the endpoint. Send the request to Repeater for later purpose.</li>
                                    <li>Click <strong>Community</strong> in the navbar to visit <a href="http://localhost:8888/forum" target="_blank" rel="noopener noreferrer">http://localhost:8888/forum</a>.</li>
                                    <li>It can be observed that the forum posts are populated based on the response from <code>/community/api/v2/community/posts/recent</code> endpoint. On further analyzing the response, it can be seen that <code>vehicleid</code> is also received back corresponding to the author of each post.</li>
                                    <li>Edit the <code>vehicleid</code> in the request sent to Repeater in Step 5 with the <code>vehicleid</code> received from the endpoint <code>/community/api/v2/community/posts/recent</code>.</li>
                                    <li>Upon sending the request, sensitive details like latitude, longitude, and full name are received in the response.</li>
                                    <li>The above challenge was completed using <strong>Burp Suite Community Edition</strong>.</li>
                                </ol>
                            </div>
                        </div>

                        <!-- Challenge 2 Solution -->
                        <div class="challenge-solution">
                            <h5>Challenge 2 - Access mechanic reports of other users</h5>
                            <div id="solution2" class="solution-content">
                                <h6>Detailed Solution</h6>
                                <ol>
                                    <li><strong>Login to the application</strong> from <a href="http://localhost:8888/login" target="_blank" rel="noopener noreferrer">http://localhost:8888/login</a>.</li>
                                    <li>After adding a vehicle, you will have an option to send a service request to a mechanic using the <strong>Contact Mechanic</strong> option.</li>
                                    <li>Observe the request sent after clicking <strong>Send Service Request</strong>. In the response of <code>/workshop/api/merchant/contact_mechanic</code>, you will find the hidden API endpoint in <code>report_link</code>.</li>
                                    <li>Navigate to the link present as the value in <code>report_link</code>.</li>
                                    <li>Change the value of <code>report_id</code> in the request to access mechanic reports of other users.</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <!-- Mass Assignment Solutions -->
                    <div class="challenge-group">
                        <h4>Mass Assignment</h4>

                        <!-- Challenge 8 Solution -->
                        <div class="challenge-solution">
                            <h5>Challenge 8 - Get an item for free</h5>
                            <div id="solution8" class="solution-content">
                                <h6>Detailed Solution</h6>
                                <ol>
                                    <li><strong>Login to the application</strong> from <a href="http://localhost:8888/login" target="_blank" rel="noopener noreferrer">http://localhost:8888/login</a>.</li>
                                    <li>Click <strong>Shop</strong> in the navbar to visit <a href="http://localhost:8888/shop" target="_blank" rel="noopener noreferrer">http://localhost:8888/shop</a>.</li>
                                    <li>There is an initial available balance of $100. Try to order the Seat item for $10 from the shop by using the <strong>Buy</strong> button and observe the request sent.</li>
                                    <li>On observing the POST request <code>/workshop/api/shop/orders</code>, it can be observed that credit has been reduced by $10 and the current available balance is $90.</li>
                                    <li>With this knowledge, send the captured POST request <code>/workshop/api/shop/orders</code> to Repeater.</li>
                                    <li>Change the value of <code>quantity</code> in the request body to a negative value and send the request. It can be observed that the available balance has now increased and the order has been placed.</li>
                                    <li>Verify that the order has been placed by going to the <strong>Past Orders</strong> section, thus completing the challenge.</li>
                                    <li>The above challenge was completed using <strong>Burp Suite Community Edition</strong>.</li>
                                </ol>
                            </div>
                        </div>

                        <!-- Challenge 9 Solution -->
                        <div class="challenge-solution">
                            <h5>Challenge 9 - Increase your balance by $1,000 or more</h5>
                            <div id="solution9" class="solution-content">
                                <h6>Detailed Solution</h6>
                                <ol>
                                    <li><strong>Login to the application</strong> from <a href="http://localhost:8888/login" target="_blank" rel="noopener noreferrer">http://localhost:8888/login</a>.</li>
                                    <li>Click <strong>Shop</strong> in the navbar to visit <a href="http://localhost:8888/shop" target="_blank" rel="noopener noreferrer">http://localhost:8888/shop</a>.</li>
                                    <li>There is an initial available balance of $100. Try to order the Seat item for $10 from the shop by using the <strong>Buy</strong> button and observe the request sent.</li>
                                    <li>On observing the POST request <code>/workshop/api/shop/orders</code>, it can be observed that credit has been reduced by $10 and the current available balance is $90.</li>
                                    <li>With this knowledge, send the captured POST request <code>/workshop/api/shop/orders</code> to Repeater.</li>
                                    <li>Change the value of <code>quantity</code> in the request body to a negative value (e.g., -100 or less) and send the request. It can be observed that the available balance has now increased by $1,000 or more.</li>
                                    <li>The above challenge was completed using <strong>Burp Suite Community Edition</strong>.</li>
                                </ol>
                            </div>
                        </div>

                        <!-- Challenge 10 Solution -->
                        <div class="challenge-solution">
                            <h5>Challenge 10 - Update internal video properties</h5>
                            <div id="solution10" class="solution-content">
                                <h6>Detailed Solution</h6>
                                <p>After solving the "Find an API endpoint that leaks an internal property of videos" challenge, follow these steps:</p>
                                <ol>
                                    <li><strong>Identify the Endpoint:</strong> Locate the API endpoint that allows updating video properties. This can typically be found by analyzing the API calls when interacting with video functionalities.</li>
                                    <li><strong>Modify the Internal Property:</strong> Once the endpoint is identified, send a request to it with modified values for internal properties. For example, changing the <code>isPrivate</code> flag or other sensitive attributes.</li>
                                    <li><strong>Exploit the Modified Property:</strong> Use the altered property to exploit further vulnerabilities, such as accessing restricted content or manipulating video visibility.</li>
                                    <li>The above challenge was completed using <strong>Burp Suite Community Edition</strong>.</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <!-- JWT Vulnerabilities Solutions -->
                    <div class="challenge-group">
                        <h4>JWT Vulnerabilities</h4>

                        <!-- Challenge 15 Solution -->
                        <div class="challenge-solution">
                            <h5>Challenge 15 - Find a way to forge valid JWT Tokens</h5>
                            <div id="solution15" class="solution-content">
                                <h6>Detailed Solution</h6>
                                <p>crAPI is vulnerable to the following JWT Vulnerabilities:</p>
                                <ul>
                                    <li><strong>JWT Algorithm Confusion Vulnerability</strong>
                                        <ul>
                                            <li>crAPI uses RS256 JWT Algorithm by default.</li>
                                            <li>The public key to verify JWT is available at <a href="http://localhost:8888/.well-known/jwks.json" target="_blank" rel="noopener noreferrer">http://localhost:8888/.well-known/jwks.json</a>.</li>
                                            <li>Convert the public key to a base64 encoded form and use it as a secret to create a JWT in HS256 Algorithm.</li>
                                            <li>This JWT will be accepted as a valid JWT Token by crAPI.</li>
                                        </ul>
                                    </li>
                                    <li><strong>Invalid Signature Vulnerability</strong>
                                        <ul>
                                            <li>User Dashboard API is not validating JWT signature.</li>
                                            <li>Create a JWT with the <code>sub</code> header set to a different user's email.</li>
                                            <li>With the above JWT, you will be able to extract user data from the User Dashboard API endpoint.</li>
                                        </ul>
                                    </li>
                                    <li><strong>JKU Misuse Vulnerability</strong>
                                        <ul>
                                            <li>crAPI will verify JWT tokens with any public key that is pointed to by the <code>jku</code> JWT header.</li>
                                            <li>Create your own public/private key pair and sign a JWT in RS256 Algorithm.</li>
                                            <li>Host the public key somewhere in JWK format.</li>
                                            <li>Pass the public key URL in the <code>jku</code> header of the JWT with an appropriate <code>kid</code> header.</li>
                                            <li>This JWT will be accepted as a valid JWT Token by crAPI.</li>
                                        </ul>
                                    </li>
                                    <li><strong>KID Path Traversal Vulnerability</strong>
                                        <ul>
                                            <li>Set the <code>kid</code> header of the JWT to <code>../../../../../../dev/null</code>.</li>
                                            <li>Create a custom JWT in HS256 algorithm with the secret as <code>AA==</code> (Base64 encoded form of Hex null byte 00).</li>
                                            <li>This JWT will be accepted as a valid JWT Token by crAPI.</li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Secret Challenges Solutions (Placeholder) -->
                    <div class="challenge-group">
                        <h4>&lt;&lt; 2 Secret Challenges &gt;&gt;</h4>
                        <p>There are two more secret challenges in crAPI, that are pretty complex, and for now we don’t share details about them, except the fact they are really cool.</p>
                    </div>
                </div>
            </section>

            <!-- Best Practices for API Security Section -->
            <section id="best-practices-for-api-security">
                <h2>Best Practices for API Security <button class="done-toggle" aria-label="Mark as Done"></button></h2>
                <div class="section-content fade-in">
                    <ul>
                        <li><strong>Authentication & Authorization:</strong>
                            <ul>
                                <li>Use strong authentication mechanisms (e.g., OAuth 2.0, JWT with strong signatures).</li>
                                <li>Implement role-based access controls to restrict access based on user roles.</li>
                            </ul>
                        </li>
                        <li><strong>Input Validation:</strong>
                            <ul>
                                <li>Sanitize and validate all user inputs to prevent injection attacks.</li>
                                <li>Use parameterized queries and ORM frameworks to handle database interactions securely.</li>
                            </ul>
                        </li>
                        <li><strong>Data Encryption:</strong>
                            <ul>
                                <li>Encrypt sensitive data both in transit (using TLS) and at rest.</li>
                                <li>Avoid exposing unnecessary data in API responses; follow the principle of least privilege.</li>
                            </ul>
                        </li>
                        <li><strong>Rate Limiting:</strong>
                            <ul>
                                <li>Implement rate limiting to prevent abuse and denial-of-service attacks.</li>
                                <li>Monitor and log API usage patterns to detect and respond to anomalies.</li>
                            </ul>
                        </li>
                        <li><strong>Error Handling:</strong>
                            <ul>
                                <li>Provide generic error messages to avoid revealing internal system details.</li>
                                <li>Log detailed errors server-side for troubleshooting and auditing purposes.</li>
                            </ul>
                        </li>
                        <li><strong>Regular Audits & Testing:</strong>
                            <ul>
                                <li>Conduct regular security assessments and penetration testing to identify vulnerabilities.</li>
                                <li>Keep dependencies and frameworks up to date to mitigate known security issues.</li>
                            </ul>
                        </li>
                        <li><strong>Use of Security Headers:</strong>
                            <ul>
                                <li>Implement HTTP security headers (e.g., Content-Security-Policy, Strict-Transport-Security) to enhance security.</li>
                            </ul>
                        </li>
                        <li><strong>Logging and Monitoring:</strong>
                            <ul>
                                <li>Maintain comprehensive logs of API activities for monitoring and forensic analysis.</li>
                                <li>Use monitoring tools to track API performance and detect suspicious activities.</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>
    </main>

    <!-- Footer Section -->
    <footer>
        <div class="container">
            <p>If you have any questions or need further assistance during the workshop, please reach out to <a href="mailto:alex@solutionsedge.io">alex@solutionsedge.io</a></p> 
        </div>
    </footer>

    <!-- Scroll-to-Top Button -->
    <button id="scrollToTopBtn" title="Go to top">&#8679;</button>

    <!-- Include External Scripts -->
    <script src="scripts.js"></script>
</body>
</html>